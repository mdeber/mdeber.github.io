<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Constructing and checking for base-pair resolution GRanges objects — makeGRangesBRG • BRGenomics</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Constructing and checking for base-pair resolution GRanges objects — makeGRangesBRG"><meta property="og:description" content="makeGRangesBRG splits up all ranges in dataset.gr to be each 1
basepair wide. For any range that is split up, all metadata information
belonging to that range is inherited by its daughter ranges, and therefore
the transformation is non-destructive. isBRG checks whether an object
is a basepair resolution GRanges object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BRGenomics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Overview.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/GettingStarted.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/ImportingModifyingAnnotations.html">Importing &amp; Modifying Annotations</a>
    </li>
    <li>
      <a href="../articles/ImportingProcessingData.html">Importing &amp; Processing Data</a>
    </li>
    <li>
      <a href="../articles/SignalCounting.html">Signal Counting</a>
    </li>
    <li>
      <a href="../articles/AnalyzingMultipleDatasets.html">Analyzing Multiple Datasets</a>
    </li>
    <li>
      <a href="../articles/ProfilePlotsAndBootstrapping.html">Profile Plots &amp; Bootstrapping</a>
    </li>
    <li>
      <a href="../articles/SpikeInNormalization.html">Spike-in Normalization</a>
    </li>
    <li>
      <a href="../articles/DESeq2WithGlobalPerturbations.html">DESeq2 with Global Perturbations</a>
    </li>
    <li>
      <a href="../articles/SequenceExtraction.html">Sequence Extraction</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mdeber/BRGenomics" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Constructing and checking for base-pair resolution GRanges objects</h1>
    <small class="dont-index">Source: <a href="https://github.com/mdeber/BRGenomics/blob/HEAD/R/dataset_functions.R" class="external-link"><code>R/dataset_functions.R</code></a></small>
    <div class="hidden name"><code>makeGRangesBRG.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>makeGRangesBRG</code> splits up all ranges in <code>dataset.gr</code> to be each 1
basepair wide. For any range that is split up, all metadata information
belonging to that range is inherited by its daughter ranges, and therefore
the transformation is non-destructive. <code>isBRG</code> checks whether an object
is a basepair resolution GRanges object.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">makeGRangesBRG</span><span class="op">(</span><span class="va">dataset.gr</span>, ncores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">isBRG</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dataset.gr</dt>
<dd><p>A disjoint GRanges object, or a list of such objects.</p></dd>


<dt>ncores</dt>
<dd><p>If <code>dataset.gr</code> is a list, the number of cores to use for
computations.</p></dd>


<dt>x</dt>
<dd><p>Object to be tested.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>makeGRangesBRG</code> returns a GRanges object for which</p>
<p></p>
<p><code>length(output) == sum(width(dataset.gr))</code>, and for which</p>
<p></p>
<p><code>all(width(output) == 1)</code>.</p>
<p></p>
<p><code>isBRG(x)</code> returns <code>TRUE</code> if <code>x</code> is a GRanges object with
  the above characteristics.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Note that <code>makeGRangesBRG</code> doesn't perform any transformation
  on the metadata in the input. This function assumes that for an input
  GRanges object, any metadata for each range is equally correct when
  inherited by each individual base in that range. In other words, the
  dataset's "signal" (usually readcounts) fundamentally belongs to a single
  basepair position.</p>
    </div>
    <div id="motivation">
    <h2>Motivation</h2>
    <p>The motivating case for this function is a bigWig file
  (e.g. one imported by <code>rtracklayer</code>), as bigWig files typically use
  run-length compression on the data signal (the 'score' column), such that
  adjacent bases sharing the same signal are combined into a single range. As
  basepair-resolution genomic data is typically sparse, this compression has
  a minimal impact on memory usage, and removing it greatly enhances data
  handling as each index (each range) of the GRanges object corresponds to a
  single genomic position.</p>
    </div>
    <div id="generating-basepair-resolution-granges-from-whole-reads">
    <h2>Generating basepair-resolution GRanges from whole reads</h2>
    <p>If working
  with a GRanges object containing whole reads, one can obtain base-pair
  resolution information by using the strand-specific function
  <code><a href="https://rdrr.io/pkg/GenomicRanges/man/intra-range-methods.html" class="external-link">GenomicRanges::resize</a></code> to
  select a single base from each read: set <code>width = 1</code> and use the
  <code>fix</code> argument to choose the strand-specific 5' or 3' end. Then,
  strand-specific coverage can be calculated using
  <code><a href="getStrandedCoverage.html">getStrandedCoverage</a></code>.</p>
    </div>
    <div id="on-the-use-of-granges-instead-of-gpos">
    <h2>On the use of GRanges instead of GPos</h2>
    <p>The
  <code><a href="https://rdrr.io/pkg/GenomicRanges/man/GPos-class.html" class="external-link">GPos</a></code> class is a more suitable
  container for data of this type, as the GPos class is specific to 1-bp-wide
  ranges. However, in early testing, we encountered some kind of
  compatibility limitations with the newer GPos class, and have not re-tested
  it since. If you have feedback on switching to this class, please contact
  the author. Users can readily coerce a basepair-resolution GRanges object
  to a GPos object via <code>gp &lt;- GPos(gr, score = score(gr))</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="getStrandedCoverage.html">getStrandedCoverage</a></code>,
  <code><a href="https://rdrr.io/pkg/GenomicRanges/man/intra-range-methods.html" class="external-link">GenomicRanges::resize()</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Mike DeBerardine</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"unix"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">#--------------------------------------------------#</span></span></span>
<span class="r-in"><span>    <span class="co"># Make a bigWig file single width</span></span></span>
<span class="r-in"><span>    <span class="co">#--------------------------------------------------#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># get local address for an included bigWig file</span></span></span>
<span class="r-in"><span>    <span class="va">bw_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"PROseq_dm6_chr4_plus.bw"</span>,</span></span>
<span class="r-in"><span>                           package <span class="op">=</span> <span class="st">"BRGenomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># BRGenomics::import_bigWig automatically applies makeGRangesBRG;</span></span></span>
<span class="r-in"><span>    <span class="co"># therefore will import using rtracklayer</span></span></span>
<span class="r-in"><span>    <span class="va">bw</span> <span class="op">&lt;-</span> <span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/BigWigFile.html" class="external-link">import.bw</a></span><span class="op">(</span><span class="va">bw_file</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">strand</span><span class="op">(</span><span class="va">bw</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"+"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># make basepair-resolution (single-width)</span></span></span>
<span class="r-in"><span>    <span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu">makeGRangesBRG</span><span class="op">(</span><span class="va">bw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu">isBRG</span><span class="op">(</span><span class="va">gr</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">gr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gr</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gr</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">score</span><span class="op">(</span><span class="va">gr</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">score</span><span class="op">(</span><span class="va">bw</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">#--------------------------------------------------#</span></span></span>
<span class="r-in"><span>    <span class="co"># Reverse using getStrandedCoverage</span></span></span>
<span class="r-in"><span>    <span class="co">#--------------------------------------------------#</span></span></span>
<span class="r-in"><span>    <span class="co"># -&gt; for more examples, see getStrandedCoverage</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">undo</span> <span class="op">&lt;-</span> <span class="fu"><a href="getStrandedCoverage.html">getStrandedCoverage</a></span><span class="op">(</span><span class="va">gr</span>, ncores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu">isBRG</span><span class="op">(</span><span class="va">undo</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">undo</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">undo</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu">score</span><span class="op">(</span><span class="va">undo</span><span class="op">)</span> <span class="op">==</span> <span class="fu">score</span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>longer object length is not a multiple of shorter object length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Mike DeBerardine.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

