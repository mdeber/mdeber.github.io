<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Constructing and checking for base-pair resolution GRanges objects — makeGRangesBRG • BRGenomics</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Constructing and checking for base-pair resolution GRanges objects — makeGRangesBRG" />
<meta property="og:description" content="makeGRangesBRG splits up all ranges in dataset.gr to be each 1
basepair wide. For any range that is split up, all metadata information
belonging to that range is inherited by its daughter ranges, and therefore
the transformation is non-destructive. isBRG checks whether an object
is a basepair resolution GRanges object." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BRGenomics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.26</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/BRGenomicsOverview.html">Basepair-Resolution Analysis with BRGenomics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Constructing and checking for base-pair resolution GRanges objects</h1>
    
    <div class="hidden name"><code>makeGRangesBRG.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>makeGRangesBRG</code> splits up all ranges in <code>dataset.gr</code> to be each 1
basepair wide. For any range that is split up, all metadata information
belonging to that range is inherited by its daughter ranges, and therefore
the transformation is non-destructive. <code>isBRG</code> checks whether an object
is a basepair resolution GRanges object.</p>
    </div>

    <pre class="usage"><span class='fu'>makeGRangesBRG</span>(<span class='no'>dataset.gr</span>, <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fu'>detectCores</span>())

<span class='fu'>isBRG</span>(<span class='no'>x</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dataset.gr</th>
      <td><p>A disjoint GRanges object, or a list of such objects.</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>If <code>dataset.gr</code> is a list, the number of cores to use for
computations.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Object to be tested.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>makeGRangesBRG</code> returns a GRanges object for which
  <code>length(output) == sum(width(dataset.gr))</code>, and for which
  <code><a href='https://rdrr.io/r/base/all.html'>all(width(output) == 1)</a></code>.</p>
<p><code>isBRG(x)</code> returns <code>TRUE</code> if <code>x</code> is a GRanges object with
  the above characteristics.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Note that <code>makeGRangesBRG</code> doesn't perform any transformation
  on the metadata in the input. This function assumes that for an input
  GRanges object, any metadata for each range is equally correct when
  inherited by each individual base in that range. In other words, the
  dataset's "signal" (usually readcounts) fundamentally belongs to a single
  basepair position.</p>
    <h2 class="hasAnchor" id="motivation"><a class="anchor" href="#motivation"></a>Motivation</h2>

    <p>The motivating case for this function is a bigWig file
  (e.g. one imported by <code>rtracklayer</code>), as bigWig files typically use
  run-length compression on the data signal (the 'score' column), such that
  adjacent bases sharing the same signal are combined into a single range. As
  basepair-resolution genomic data is typically sparse, this compression has
  a minimal impact on memory usage, and removing it greatly enhances data
  handling as each index (each range) of the GRanges object corresponds to a
  single genomic position.</p>
    <h2 class="hasAnchor" id="generating-basepair-resolution-granges-from-whole-reads"><a class="anchor" href="#generating-basepair-resolution-granges-from-whole-reads"></a>Generating basepair-resolution GRanges from whole reads</h2>

    <p>If working
  with a GRanges object containing whole reads, one can obtain base-pair
  resolution information by using the strand-specific function
  <code><a href='https://rdrr.io/pkg/GenomicRanges/man/intra-range-methods.html'>GenomicRanges::resize</a></code> to
  select a single base from each read: set <code>width = 1</code> and use the
  <code>fix</code> argument to choose the strand-specific 5' or 3' end. Then,
  strand-specific coverage can be calculated using
  <code><a href='getStrandedCoverage.html'>getStrandedCoverage</a></code>.</p>
    <h2 class="hasAnchor" id="on-the-use-of-granges-instead-of-gpos"><a class="anchor" href="#on-the-use-of-granges-instead-of-gpos"></a>On the use of GRanges instead of GPos</h2>

    <p>The
  <code><a href='https://rdrr.io/pkg/GenomicRanges/man/GPos-class.html'>GPos</a></code> class is a more suitable
  container for data of this type, as the GPos class is specific to 1-bp-wide
  ranges. However, in early testing, we encountered some kind of
  compatibility limitations with the newer GPos class, and have not re-tested
  it since. If you have feedback on switching to this class, please contact
  the author. Users can readily coerce a basepair-resolution GRanges object
  to a GPos object via <code>gp &lt;- GPos(gr, score = score(gr))</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='getStrandedCoverage.html'>getStrandedCoverage</a></code>,
  <code><a href='https://rdrr.io/pkg/GenomicRanges/man/intra-range-methods.html'>GenomicRanges::resize()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='no'>.Platform</span>$<span class='no'>OS.type</span> <span class='kw'>==</span> <span class='st'>"unix"</span>) {

    <span class='co'>#--------------------------------------------------#</span>
    <span class='co'># Make a bigWig file single width</span>
    <span class='co'>#--------------------------------------------------#</span>

    <span class='co'># get local address for an included bigWig file</span>
    <span class='no'>bw_file</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"PROseq_dm6_chr4_plus.bw"</span>,
                           <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"BRGenomics"</span>)

    <span class='co'># BRGenomics::import_bigWig automatically applies makeGRangesBRG;</span>
    <span class='co'># therefore will import using rtracklayer</span>
    <span class='no'>bw</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rtracklayer</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rtracklayer/man/BigWigFile.html'>import.bw</a></span>(<span class='no'>bw_file</span>)
    <span class='fu'>strand</span>(<span class='no'>bw</span>) <span class='kw'>&lt;-</span> <span class='st'>"+"</span>

    <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='fu'>width</span>(<span class='no'>bw</span>))
    <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>bw</span>)

    <span class='co'># make basepair-resolution (single-width)</span>
    <span class='no'>gr</span> <span class='kw'>&lt;-</span> <span class='fu'>makeGRangesBRG</span>(<span class='no'>bw</span>)

    <span class='fu'>isBRG</span>(<span class='no'>gr</span>)
    <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='fu'>width</span>(<span class='no'>gr</span>))
    <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>gr</span>)
    <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>gr</span>) <span class='kw'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='fu'>width</span>(<span class='no'>bw</span>))
    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='fu'>score</span>(<span class='no'>gr</span>)) <span class='kw'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='fu'>score</span>(<span class='no'>bw</span>) * <span class='fu'>width</span>(<span class='no'>bw</span>))

    <span class='co'>#--------------------------------------------------#</span>
    <span class='co'># Reverse using getStrandedCoverage</span>
    <span class='co'>#--------------------------------------------------#</span>
    <span class='co'># -&gt; for more examples, see getStrandedCoverage</span>

    <span class='no'>undo</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getStrandedCoverage.html'>getStrandedCoverage</a></span>(<span class='no'>gr</span>, <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>1</span>)

    <span class='fu'>isBRG</span>(<span class='no'>undo</span>)
    <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='fu'>width</span>(<span class='no'>undo</span>))
    <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>undo</span>) <span class='kw'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>bw</span>)
    <span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span>(<span class='fu'>score</span>(<span class='no'>undo</span>) <span class='kw'>==</span> <span class='fu'>score</span>(<span class='no'>bw</span>))

}</div><div class='output co'>#&gt; <span class='warning'>Warning: longer object length is not a multiple of shorter object length</span></div><div class='output co'>#&gt; [1] FALSE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#motivation">Motivation</a></li>
      <li><a href="#generating-basepair-resolution-granges-from-whole-reads">Generating basepair-resolution GRanges from whole reads</a></li>
      <li><a href="#on-the-use-of-granges-instead-of-gpos">On the use of GRanges instead of GPos</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Mike DeBerardine</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mike DeBerardine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


