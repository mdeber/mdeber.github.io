<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Iterative Subsampling for Metaplotting (With Scaled Regions) — md.meta.scaled_subsample • BRGenomics</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Iterative Subsampling for Metaplotting (With Scaled Regions) — md.meta.scaled_subsample" />
<meta property="og:description" content="This function can perform iterative metaplot subsampling in several configurations. All arguments for
regions-of-interest for metaplot subsampling are optional, as long as at least one region is supplied.
Unnamed arguments are regions-of-interest of variable &quot;widths&quot; (i.e. &quot;lengths&quot; in basepairs) over which to
perform length-scaled metaplot subsampling. Length-scaled metaplot subsampling involves dividing each
range (e.g. each region-of-interest) into nbins_scaled number of equally-sized bins, and obtaining
signal counts in each bin, divided by the size of the bin for that particular region-of-interest.
Non-length-scaled subsampling (as would be done using md.meta.subsample) is performed on the named
arguments linear_regions_start.gr and linear_regions_end.gr. The output is constructed in
the order linear_regions_start.gr, unnamed scaled regions (in order given), and then
linear_regions_end.gr, with x-values corresponding to the bin number." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BRGenomics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Iterative Subsampling for Metaplotting (With Scaled Regions)</h1>
    
    <div class="hidden name"><code>md.meta.scaled_subsample.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function can perform iterative metaplot subsampling in several configurations. All arguments for
regions-of-interest for metaplot subsampling are optional, as long as at least one region is supplied.
Unnamed arguments are regions-of-interest of variable "widths" (i.e. "lengths" in basepairs) over which to
perform length-scaled metaplot subsampling. Length-scaled metaplot subsampling involves dividing each
range (e.g. each region-of-interest) into <code>nbins_scaled</code> number of equally-sized bins, and obtaining
signal counts in each bin, divided by the size of the bin for that particular region-of-interest.
Non-length-scaled subsampling (as would be done using <code>md.meta.subsample</code>) is performed on the named
arguments <code>linear_regions_start.gr</code> and <code>linear_regions_end.gr</code>. The output is constructed in
the order <code>linear_regions_start.gr</code>, unnamed scaled regions (in order given), and then
<code>linear_regions_end.gr</code>, with x-values corresponding to the bin number.</p>
    </div>

    <pre class="usage"><span class='fu'>md.meta.scaled_subsample</span>(
  <span class='no'>dataset.gr</span>,
  <span class='no'>...</span>,
  <span class='kw'>linear_regions_start.gr</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>linear_regions_end.gr</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>nbins_scaled</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>nbins_linear_start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='fu'>width</span>(<span class='no'>linear_regions_start.gr</span>)),
  <span class='kw'>nbins_linear_end</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='fu'>width</span>(<span class='no'>linear_regions_end.gr</span>)),
  <span class='kw'>sample_name</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/deparse.html'>deparse</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/substitute.html'>substitute</a></span>(<span class='no'>dataset.gr</span>)),
  <span class='kw'>n.iter</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>prop.subsample</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>lower</span> <span class='kw'>=</span> <span class='fl'>0.125</span>,
  <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fl'>0.875</span>,
  <span class='kw'>NF</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>field</span> <span class='kw'>=</span> <span class='st'>"score"</span>,
  <span class='kw'>remove.empty</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>1</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dataset.gr</th>
      <td><p>A GRanges object in which signal is contained in metadata (typically in the "score" field).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>0 or more GRanges objects containing regions of interest over which to do length-scaled signal
counting and metaplot subsampling. The output x-positions will be determined by the order in which these
regions are supplied, the number of bins used for counting signal within variable length regions
(<code>nbins_scaled</code>), and whether or not a <code>linear_regions_start.gr</code> object is given.</p></td>
    </tr>
    <tr>
      <th>linear_regions_start.gr</th>
      <td><p>Optional GRanges object containing regions of interest over which to do
linear (un-scaled) signal counting and metaplot subsampling. Because no length-scaling is performed,
all ranges must have the same width. These regions will be put before any supplied regions for
length-scaled metaplot subsampling, i.e. the first <code>nbins_linear_start</code> x-values will be from
subsampling <code>linear_regions_start.gr</code>.</p></td>
    </tr>
    <tr>
      <th>linear_regions_end.gr</th>
      <td><p>Optional GRanges object containing regions of interest over which to do
linear (un-scaled) signal counting and metaplot subsampling. Because no length-scaling is performed,
all ranges must have the same width. These regions will be placed after any supplied regions for
length-scaled metaplot subsampling, i.e. the last <code>nbins_linear_end</code> x-values will be from
subsampling <code>linear_regions_end.gr</code>.</p></td>
    </tr>
    <tr>
      <th>nbins_scaled</th>
      <td><p>The number of bins to use for length scaling signal counts.</p></td>
    </tr>
    <tr>
      <th>nbins_linear_start</th>
      <td><p>The number of bins to use for counting signal within <code>linear_regions_start.gr</code>.
Defaults to the width of the regions, i.e. a binsize of 1 (no binning).</p></td>
    </tr>
    <tr>
      <th>nbins_linear_end</th>
      <td><p>The number of bins to use for counting signal within <code>linear_regions_end.gr</code>.
Defaults to the width of the regions, i.e. a binsize of 1 (no binning).</p></td>
    </tr>
    <tr>
      <th>sample_name</th>
      <td><p>Defaults to the name of <code>dataset.gr</code>.</p></td>
    </tr>
    <tr>
      <th>n.iter</th>
      <td><p>Number of random subsampling iterations to perform. Default is 1000.</p></td>
    </tr>
    <tr>
      <th>prop.subsample</th>
      <td><p>The proportion of the genelist (regions.gr) to subsample in each iteration.
The default is 0.1.</p></td>
    </tr>
    <tr>
      <th>lower</th>
      <td><p>The lower quantile of subsampled signal means to return. The default is
0.125 (12.5th percentile).</p></td>
    </tr>
    <tr>
      <th>upper</th>
      <td><p>The upper quantile of subsampled signal means to return. The default is
0.875 (85.5th percentile).</p></td>
    </tr>
    <tr>
      <th>NF</th>
      <td><p>Optional normalization factor by which to multiply the counts.</p></td>
    </tr>
    <tr>
      <th>field</th>
      <td><p>The metadata field of <code>dataset.gr</code> to be counted.</p></td>
    </tr>
    <tr>
      <th>remove.empty</th>
      <td><p>A logical indicating whether regions without signal should be removed from the analysis.</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>Number of cores to use for parallel computation. As of writing, parallel processing doesn't
show any benefit for short computation times (e.g. &lt;1 minute for our typical experience on a laptop).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Dataframe containing x-values, means, lower quantiles, upper quantiles, and the sample name (as a
convenience for row-binding multiple output dataframes). X-values correspond to bins based on the input
regions given and the specified binsizes to use.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The user must be able to determine the correct meaning of the bin numbers in the final output, and for
that reason arguments for binning are always explicitly the number of bins, and not the size of the bins
(as would be possible for linear (un-scaled) regions). For example, if the user provides
<code>linear_regions_start.gr</code>, one unnamed GRanges for length-scaled subsampling, and
<code>linear_regions_end.gr</code>, the output x-values <code>1:nbins_linear_start</code> will correspond to
equally-sized bins in <code>linear_regions_start.gr</code>; the subsequent <code>nbins_scaled</code> x-values will
correspond to variably-sized bins in the unnamed GRanges object given, and the final
<code>nbins_linear_end</code> x-values will correspond to equally-sized bins in <code>linear_regions_end.gr</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>md.meta.scaled_subsample</span>(<span class='no'>my_proseq_data</span>, <span class='no'>genes.early_genebodies</span>, <span class='no'>genes.late_genebodies</span>,
<span class='kw'>linear_regions_start.gr</span> <span class='kw'>=</span> <span class='no'>genes.promoter_proximal</span>, <span class='kw'>linear_regions_end.gr</span> <span class='kw'>=</span> <span class='no'>genes.cps_proximal</span>,
<span class='kw'>nbins_scaled</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>nbins_linear_end</span> <span class='kw'>=</span> <span class='fl'>500</span>)</div><div class='output co'>#&gt; <span class='error'>Error in md.meta.scaled_subsample(my_proseq_data, genes.early_genebodies,     genes.late_genebodies, linear_regions_start.gr = genes.promoter_proximal,     linear_regions_end.gr = genes.cps_proximal, nbins_scaled = 500,     nbins_linear_end = 500): object 'genes.early_genebodies' not found</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mike DeBerardine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


