<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find sites with max signal in regions of interest — getMaxPositionsBySignal • BRGenomics</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Find sites with max signal in regions of interest — getMaxPositionsBySignal" />
<meta property="og:description" content="For each signal-containing region of interest, find the single site with the
most signal. Sites can be found at base-pair resolution, or defined for
larger bins." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BRGenomics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find sites with max signal in regions of interest</h1>
    
    <div class="hidden name"><code>getMaxPositionsBySignal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For each signal-containing region of interest, find the single site with the
most signal. Sites can be found at base-pair resolution, or defined for
larger bins.</p>
    </div>

    <pre class="usage"><span class='fu'>getMaxPositionsBySignal</span>(
  <span class='no'>regions.gr</span>,
  <span class='no'>dataset.gr</span>,
  <span class='kw'>binsize</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>bin.centers</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>field</span> <span class='kw'>=</span> <span class='st'>"score"</span>,
  <span class='kw'>keep.score</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>regions.gr</th>
      <td><p>A GRanges object containing regions of interest.</p></td>
    </tr>
    <tr>
      <th>dataset.gr</th>
      <td><p>A GRanges object in which signal is contained in metadata
(typically in the "score" field).</p></td>
    </tr>
    <tr>
      <th>binsize</th>
      <td><p>The size of bin in which to calculate signal scores.</p></td>
    </tr>
    <tr>
      <th>bin.centers</th>
      <td><p>Logical indicating if the centers of bins are returned, as
opposed to the entire bin. If <code>TRUE</code>,</p></td>
    </tr>
    <tr>
      <th>field</th>
      <td><p>The metadata field of <code>dataset.gr</code> to be counted.</p></td>
    </tr>
    <tr>
      <th>keep.score</th>
      <td><p>Logical indicating if the signal value at the max site
should be reported. If set to <code>TRUE</code>, the values are kept as a new
metadata column in <code>regions.gr</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Output is a GRanges object with regions.gr metadata, but each range
  only contains the site within each <code>regions.gr</code> range that had the
  most signal. If <code>binsize &gt; 1</code>, the entire bin is returned, unless
  <code>bin.centers = TRUE</code>, in which case a single-base site is returned.
  The site is set to the center of the bin, and if the binsize is even, the
  site is rounded to be closer to the beginning of the range.</p>
<p>If <code>keep.score = TRUE</code>, the output will also contain metadata for the
  signal at the max site. The output is <em>not</em> necessarily same length as
  <code>regions.gr</code>, as regions without signal are not returned. If <em>no
  regions</em> have signal (e.g. as could happen if running this function on a
  single region), the function will return an empty GRanges object with
  intact metadata columns.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='getCountsByPositions.html'>getCountsByPositions</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"PROseq"</span>) <span class='co'># load included PROseq data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"txs_dm6_chr4"</span>) <span class='co'># load included transcripts</span>

<span class='co'>#--------------------------------------------------#</span>
<span class='co'># first 50 bases of transcripts</span>
<span class='co'>#--------------------------------------------------#</span>

<span class='no'>pr</span> <span class='kw'>&lt;-</span> <span class='fu'>promoters</span>(<span class='no'>txs_dm6_chr4</span>, <span class='fl'>0</span>, <span class='fl'>50</span>)
<span class='no'>pr</span>[<span class='fl'>1</span>:<span class='fl'>3</span>]</div><div class='output co'>#&gt; GRanges object with 3 ranges and 2 metadata columns:
#&gt;       seqnames      ranges strand |     tx_name     gene_id
#&gt;          &lt;Rle&gt;   &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;
#&gt;   [1]     chr4     879-928      + | FBtr0346692 FBgn0267363
#&gt;   [2]     chr4 42774-42823      + | FBtr0344900 FBgn0266617
#&gt;   [3]     chr4 44774-44823      + | FBtr0340499 FBgn0265633
#&gt;   -------
#&gt;   seqinfo: 7 sequences from dm6 genome</div><div class='input'>
<span class='co'>#--------------------------------------------------#</span>
<span class='co'># max sites</span>
<span class='co'>#--------------------------------------------------#</span>

<span class='fu'>getMaxPositionsBySignal</span>(<span class='no'>pr</span>[<span class='fl'>1</span>:<span class='fl'>3</span>], <span class='no'>PROseq</span>, <span class='kw'>keep.score</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; GRanges object with 2 ranges and 3 metadata columns:
#&gt;       seqnames    ranges strand |     tx_name     gene_id MaxSiteScore
#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;    &lt;numeric&gt;
#&gt;   [1]     chr4     42799      + | FBtr0344900 FBgn0266617            3
#&gt;   [2]     chr4     44801      + | FBtr0340499 FBgn0265633            1
#&gt;   -------
#&gt;   seqinfo: 7 sequences from dm6 genome</div><div class='input'>
<span class='co'>#--------------------------------------------------#</span>
<span class='co'># max sites in 5 bp bins</span>
<span class='co'>#--------------------------------------------------#</span>

<span class='fu'>getMaxPositionsBySignal</span>(<span class='no'>pr</span>[<span class='fl'>1</span>:<span class='fl'>3</span>], <span class='no'>PROseq</span>, <span class='kw'>binsize</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>keep.score</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; GRanges object with 2 ranges and 3 metadata columns:
#&gt;       seqnames      ranges strand |     tx_name     gene_id MaxSiteScore
#&gt;          &lt;Rle&gt;   &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;    &lt;numeric&gt;
#&gt;   [1]     chr4 42794-42798      + | FBtr0344900 FBgn0266617            4
#&gt;   [2]     chr4 44799-44803      + | FBtr0340499 FBgn0265633            1
#&gt;   -------
#&gt;   seqinfo: 7 sequences from dm6 genome</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Mike DeBerardine</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mike DeBerardine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


